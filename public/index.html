<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data Selfie App</title>
    <style>
      body {
        background-color: rgb(0, 43, 54);
        color: rgb(101, 123, 131);
        padding: 0;
        margin: 0;
      }
    </style>
  </head>
  <body>
    <h1>Selfie App</h1>
    <p>Where in the world am I!
      </br></br>
      Latitude: <span id="latitude"></span>&deg;</br>
      Longitude: <span id="longitude"></span>&deg;</br>
    </p>
    <button id="geolocate">Geolocate</button>
    <script>
      console.log('Here There Be Dragons');
      // Obtain current user position in lat and long coords.
      document.getElementById('geolocate').addEventListener('click', event => {
        if ('geolocation' in navigator) {
          console.log('Geolocation available.');
          navigator.geolocation.getCurrentPosition(async position => {
            const lat = position.coords.latitude;
            const long = position.coords.longitude;
            document.getElementById('latitude').textContent = lat;
            document.getElementById('longitude').textContent = long;

            // Create a coordinate data js object.
            const coordData = { lat, long };
            // Package the js object as a POST.
            const options = {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
                // 'Content-Type': 'application/x-www-form-urlencoded',
              },
              body: JSON.stringify(coordData) // body data type must match "Content-Type" header
            };
            // Send the package to my end point.
            const response = await fetch('/api', options);
            const data = await response.json();
            console.log(data);
            console.log(position); // Logs all current user position information.
          });
        } else {
          console.log('Geolocation NOT available.');
        }
    });
    </script>
  </body>
</html>
